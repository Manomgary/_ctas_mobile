<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
      <mat-grid-list cols="4" rowHeight="60px">
        <mat-grid-tile colspan="4" rowspan="1" style.background = "lightgreen">
           Projet: {{ projet.nom }}
        </mat-grid-tile>
        <mat-grid-tile colspan="2" rowspan="1" style.background = "lightblue">
          Region: {{region.nom_reg}}
        </mat-grid-tile>
        <mat-grid-tile colspan="2" rowspan="1" style.background = "#DDBDF1">
          District: {{district.nom_dist}}
        </mat-grid-tile>
      </mat-grid-list>
  </ion-toolbar>
</ion-header>

<ion-content>
  <mat-tab-group mat-align-tabs="start" (selectedIndexChange)="selectMatTab($event)">
    <mat-tab label="MEP-Suivi">  
      <div class="contonaire-content-flex">
        <div class="flex-container width100" fxLayout="column" style="padding-left: 5px;">
          <!--Column filter-->
          <div class="content-column-child-1" fxLayoutAlign="center center" style="justify-content: flex-start;">
            <div fxLayout="row">
              <!--Filtre-->
              <div class="row-level-1" fxLayout="row">
                <!--child bloc-->
                <div class="row-child-level1">
                  <mat-form-field floatLabel="never">
                    <!--<mat-label>Filtre par association</mat-label>-->
                    <mat-select [(ngModel)]="selectedAssoc" (ngModelChange)="applyFilterSelect($event, 'association')"
                      placeholder="Filtre par bloc">
                      <mat-option (click)="applyFilterTout('association')">tout</mat-option>
                      <mat-option *ngFor="let bloc of data_bloc" [value]="data_bloc">
                        {{ bloc.nom_bloc }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <!--child beneficiaire-->
                <div class="row-child-level1">
                  <mat-form-field floatLabel="never">
                    <!--<mat-label>Filtre par association</mat-label>-->
                    <mat-select [(ngModel)]="selectedAssoc" (ngModelChange)="applyFilterSelect($event, 'association')"
                      placeholder="Filtre par beneficiaire">
                      <mat-option (click)="applyFilterTout('association')">tout</mat-option>
                      <mat-option *ngFor="let benef of filterBeneficiaire" [value]="benef">
                        {{ benef.prenom }} {{ benef.nom }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <!--child parcelle-->
                <div class="row-child-level1">
                  <mat-form-field floatLabel="never">
                    <!--<mat-label>Filtre par association</mat-label>-->
                    <mat-select [(ngModel)]="selectedAssoc" (ngModelChange)="applyFilterSelect($event, 'association')"
                      placeholder="Filtre par parcelle">
                      <mat-option (click)="applyFilterTout('association')">tout</mat-option>
                      <mat-option *ngFor="let assoc of filterDataAssoc" [value]="assoc">
                        {{ assoc.nom_assoc }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>
              <!--Column botton-->
              <div class="row-level-1" fxLayout="row">
                <div class="row-child-level">
                  <!--<ion-button (click)="logAccordionValue()">Export</ion-button>-->
                </div>
                <div class="row-child-level">
                  <ion-button (click)="onUpdate()" *ngIf="!isUpdated">Modifier</ion-button>
                  <ion-button (click)="onFinished()" *ngIf="isUpdated">Terminer</ion-button>
                </div>
              </div>
            </div>
          </div>
          <!--Column content-->
          <div class="content-column-child-2" style="justify-content: flex-start;">
            <!--Accordion liste-->

            <!-- Multiple Accordions -->
            <ion-accordion-group mode="ios" [multiple]="true" [value]="['sg']">
              <!--Semences en grains-->
              <ion-accordion value="sg">
                <ion-item slot="header" class="level1">
                  <ion-label>Semences en grains</ion-label>
                </ion-item>

                <div slot="content">
                  <div class="flex-container width100" fxLayout="column" style="padding-left: 5px;">
                    <!--Column Bouton-->
                    <div class="child-column" fxLayout="row">
                      <div class="chil-row">
                        <button mat-raised-button (click)="toggleTableRows({src: 'mep-sg'})" color="primary">Tout afficher</button>
                      </div>
                      <div class="chil-row">
                        <button mat-raised-button (click)="onExport('mep-sg')" *ngIf="!isUpdated" [disabled]="src_MepSg.length == 0">Exporter</button>
                      </div>
                      <div class="chil-row">
                        <button mat-raised-button (click)="onAdd('mep-sg')" *ngIf="isUpdated" [disabled]="isRowMepSgEdit || isAddMepSg || isRowMepPaEdit || isAddMepPa || isAddMepMv || isRowMepMvEdit">Ajouter</button>
                      </div>
                    </div>
                    <!--Table modifier-->
                    <div class="child-column">
                      <div class="container-matTab mat-elevation-z8">
                        <div class="table-container">
                          <table mat-table [dataSource]="dataSourceMepSg" multiTemplateDataRows>
    
                            <!-- Annee Column -->
                            <ng-container matColumnDef="annee">
                              <th mat-header-cell *matHeaderCellDef> Annee </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.annee_du}} 
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.annee_du }} 
                                </span>
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="new_annee">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.annee_du }} </th>
                            </ng-container>
                  
                            <!-- Saison Column -->
                            <ng-container matColumnDef="saison">
                              <th mat-header-cell *matHeaderCellDef> Saison </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.intitule}} 
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.nom_saison }} 
                                </span>
                              </td>
                            </ng-container>       
                            <ng-container matColumnDef="new_saison">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_saison }} </th>
                            </ng-container>               
                  
                            <!-- Bloc Column -->
                            <ng-container matColumnDef="bloc">
                              <th mat-header-cell *matHeaderCellDef> Bloc </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">  
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.nom_bl}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.nom_bloc }} 
                                </span>
                              </td>
                            </ng-container>  
                            <ng-container matColumnDef="new_bloc">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_bloc }} </th>
                            </ng-container>            
                  
                            <!-- Parcelle Column -->
                            <ng-container matColumnDef="parcelle">
                              <th mat-header-cell *matHeaderCellDef> code_parce </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.id_parce}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.id_parce }} 
                                </span>
                              </td>
                            </ng-container>  
                            <ng-container matColumnDef="new_parcelle">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.id_parce }} </th>
                            </ng-container>            
                  
                            <!-- code_benef Column -->
                            <ng-container matColumnDef="code_benef">
                              <th mat-header-cell *matHeaderCellDef> code_benef </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.code_benef_bl}} 
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.id_benef }} 
                                </span>
                              </td>
                            </ng-container>      
                            <ng-container matColumnDef="new_code_benef">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.id_benef }} </th>
                            </ng-container>          
                  
                            <!-- nom_benef Column -->
                            <ng-container matColumnDef="nom_benef">
                              <th mat-header-cell *matHeaderCellDef> Nom </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.nom}} {{row.prenom}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.nom_benef }} 
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_nom_benef">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_benef }} </th>
                            </ng-container>               
                  
                            <!-- date de passage Column -->
                            <ng-container matColumnDef="ddp">
                              <th mat-header-cell *matHeaderCellDef> DDP </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.ddp}} 
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.ddp }} 
                                </span>
                              </td>
                            </ng-container>  
                            <ng-container matColumnDef="new_ddp">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.ddp }} </th>
                            </ng-container>
                            
                            <!-- espece Column -->
                            <ng-container matColumnDef="variette">
                              <th mat-header-cell *matHeaderCellDef> Variette </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.nom_var}} 
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.nom_var }} 
                                </span>
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="new_variette">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_var }} </th>
                            </ng-container>
                  
                            <!-- qso Column -->
                            <ng-container matColumnDef="qso">
                              <th mat-header-cell *matHeaderCellDef> QSO </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.qso}} 
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.qso }} 
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_qso">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.qso }} </th>
                            </ng-container>               
                  
                            <!-- Date de semis Column -->
                            <ng-container matColumnDef="dds">
                              <th mat-header-cell *matHeaderCellDef> DDS </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">  
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.dds}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.dds }} 
                                </span>
                              </td>
                            </ng-container>   
                            <ng-container matColumnDef="new_dds">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.dds }} </th>
                            </ng-container>                
                
                            <!-- sfce  Column -->
                            <ng-container matColumnDef="sfce_embl">
                              <th mat-header-cell *matHeaderCellDef> sfce_embl </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.sfce}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.sfce }} 
                                </span>
                              </td>
                            </ng-container>    
                            <ng-container matColumnDef="new_sfce_embl">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.sfce }} </th>
                            </ng-container>
                
                            <!-- sc Column -->
                            <ng-container matColumnDef="sc">
                              <th mat-header-cell *matHeaderCellDef> sc </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.sc}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.sc }} 
                                </span>
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="new_sc">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.sc }} </th>
                            </ng-container>

                            <!-- culture associé Column -->
                            <ng-container matColumnDef="ea">
                              <th mat-header-cell *matHeaderCellDef> EA </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span  *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.ea}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.ea }} 
                                </span>
                              </td>
                            </ng-container>
                            <!-- New culture associé Column -->
                            <ng-container matColumnDef="new_ea">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.ea }} </th>
                            </ng-container>

                            <!-- nbre_ligne  Column -->
                            <ng-container matColumnDef="nbre_ligne">
                              <th mat-header-cell *matHeaderCellDef> nbre_ligne </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.nbre_ligne}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.nbre_ligne }}
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_nbre_ligne">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nbre_ligne }} </th>
                            </ng-container>

                            <!-- long_ligne  Column -->
                            <ng-container matColumnDef="long_ligne">
                              <th mat-header-cell *matHeaderCellDef> long_ligne </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.long_ligne}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.long_ligne }}
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_long_ligne">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.long_ligne }} </th>
                            </ng-container>

                            <!-- New action Column -->
                            <ng-container matColumnDef="new_action">
                              <th mat-header-cell *matHeaderCellDef>
                                <a (click)="onSaveAddMep('mep-sg')">Done</a> |
                                <a (click)="onCancelAddMep('mep-sg')">Cancel</a>
                              </th>
                            </ng-container>

                            <!-- action Column -->
                            <ng-container matColumnDef="action">
                              <th mat-header-cell *matHeaderCellDef> Action </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit && isUpdated">
                                  <a (click)="onClickSaveEdit({src: 'mep-sg', data: row})">modifier</a> |
                                  <a (click)="onClickCancelEdit('mep-sg')">Annuler</a>
                                </span>
                                <span *ngIf="!isUpdated">
                                  <button mat-flat-button class="btn-info btn-dimension" (click)="row.isExpanded = !row.isExpanded">suivi</button>
                                </span>
                                <div *ngIf="isUpdated && !isRowMepSgEdit && !isAddMepSg && !isRowMepPaEdit && !isAddMepPa && !isAddMepMv && !isRowMepMvEdit" fxLayout="row">
                                  <div class="child-row-btn">
                                    <a (click)="onEditElem({data: row, src: 'mep-sg', index: i})">Edit</a>
                                  </div>
                                  <div class="child-row-btn">
                                    <button mat-flat-button class="btn-info btn-dimension" (click)="onAddShowSuivi({src: 'mep-sg', index_: i})">Afficher</button>
                                  </div>
                                </div>
                              </td>
                            </ng-container>

                            <!-- Template for Suivi-->
                            <ng-container matColumnDef="expandedDetail">
                              <td mat-cell *matCellDef="let element_mep; dataIndex as ind_mep" [attr.colspan]="displayedColumnsMepSg.length">
                    
                                <div class="row sv-element-detail" [@detailExpand]="element_mep.isExpanded && element_mep.suivi_Mep.length > 0 || isUpdated && element_mep.isExpanded? 'expanded' : 'collapsed'">
                                  <table mat-table [dataSource]="element_mep.suivi_Mep">
                                    <!-- DDP Column -->
                                    <ng-container matColumnDef="ddp">
                                      <th mat-header-cell *matHeaderCellDef> DDP </th>
                                      <td mat-cell *matCellDef="let row; let i = index"> 
                                        <span *ngIf="!isRowSvSgEdit || (isRowSvSgEdit && indexSg != i && indexRowEditMepSg == ind_mep) || (indexRowEditMepSg != ind_mep && isRowSvSgEdit)">
                                          {{row.ddp | customDate}}
                                        </span>
                                        <span *ngIf="indexSg == i && indexRowEditMepSg == ind_mep && isRowSvSgEdit">
                                          {{updated_Suivi.ddp | customDate}}
                                        </span>
                                      </td>
                                    </ng-container>
                                    <!--New DDP Column -->
                                    <ng-container matColumnDef="new_ddp">
                                      <th mat-header-cell *matHeaderCellDef> 
                                        <span>
                                          {{updated_Suivi.ddp | customDate}}
                                        </span> 
                                      </th>
                                    </ng-container>  
  
                                    <!-- Longueur Ligne Column -->
                                    <ng-container matColumnDef="long_ligne">
                                      <th mat-header-cell *matHeaderCellDef> Long_ligne </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvSgEdit || (isRowSvSgEdit && indexSg != i && indexRowEditMepSg == ind_mep) || (indexRowEditMepSg != ind_mep && isRowSvSgEdit)">
                                          {{row.long_ligne}}
                                        </span>
                                        <span *ngIf="indexSg == i && indexRowEditMepSg == ind_mep && isRowSvSgEdit">
                                          {{updated_Suivi.long_ligne}}
                                        </span>
                                      </td>
                                    </ng-container>  
                                    <ng-container matColumnDef="new_long_ligne">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.long_ligne}}
                                        </span>
                                      </th>
                                    </ng-container>
                                    
                                    <!-- Nbre_Ligne Ligne Column -->
                                    <ng-container matColumnDef="nbre_ligne">
                                      <th mat-header-cell *matHeaderCellDef> Nb ligne </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvSgEdit || (isRowSvSgEdit && indexSg != i && indexRowEditMepSg == ind_mep) || (indexRowEditMepSg != ind_mep && isRowSvSgEdit)">
                                          {{row.nbre_ligne}}
                                        </span>
                                        <span *ngIf="indexSg == i && indexRowEditMepSg == ind_mep && isRowSvSgEdit">
                                          {{updated_Suivi.nbre_ligne}}
                                        </span>
                                      </td>
                                    </ng-container>
                                    <ng-container matColumnDef="new_nbre_ligne">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.nbre_ligne}}
                                        </span>
                                      </th>
                                    </ng-container>               
                          
                                    <!-- stc Column -->
                                    <ng-container matColumnDef="stc">
                                      <th mat-header-cell *matHeaderCellDef> STC </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvSgEdit || (isRowSvSgEdit && indexSg != i && indexRowEditMepSg == ind_mep) || (indexRowEditMepSg != ind_mep && isRowSvSgEdit)">
                                          {{row.stc}}
                                        </span>
                                        <span *ngIf="indexSg == i && indexRowEditMepSg == ind_mep && isRowSvSgEdit">
                                          {{updated_Suivi.stc != null?updated_Suivi.stc.intitule:null}}
                                        </span>
                                      </td>
                                    </ng-container> 
                                    <!-- new stc Column -->
                                    <ng-container matColumnDef="new_stc">
                                      <th mat-header-cell *matHeaderCellDef>  
                                        <span>
                                          {{updated_Suivi.stc != null?updated_Suivi.stc.intitule:null}}
                                        </span>
                                      </th>
                                    </ng-container>
                                    
                                    <!-- Etat Cultural Column -->
                                    <ng-container matColumnDef="ec">
                                      <th mat-header-cell *matHeaderCellDef> Etat </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvSgEdit || (isRowSvSgEdit && indexSg != i && indexRowEditMepSg == ind_mep) || (indexRowEditMepSg != ind_mep && isRowSvSgEdit)">
                                          {{row.ec}}
                                        </span>
                                        <span *ngIf="indexSg == i && indexRowEditMepSg == ind_mep && isRowSvSgEdit">
                                          {{updated_Suivi.ec != null?updated_Suivi.ec.intitule:null}}
                                        </span>
                                      </td>
                                    </ng-container> 
                                    <!-- new Etat Cultural Column -->
                                    <ng-container matColumnDef="new_ec">
                                      <th mat-header-cell *matHeaderCellDef>  
                                        <span>
                                          {{updated_Suivi.ec != null?updated_Suivi.ec.intitule:null}}
                                        </span>
                                      </th>
                                    </ng-container>
                          
                                    <!-- Image culture Column -->
                                    <ng-container matColumnDef="img_cult">
                                      <th mat-header-cell *matHeaderCellDef> img_cult </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvSgEdit || (isRowSvSgEdit && indexSg != i && indexRowEditMepSg == ind_mep) || (indexRowEditMepSg != ind_mep && isRowSvSgEdit)">
                                          <ion-thumbnail slot="start">
                                            <ion-img [src]="row.img_cult"></ion-img>
                                          </ion-thumbnail>
                                        </span>
                                        <span *ngIf="indexSg == i && indexRowEditMepSg == ind_mep && isRowSvSgEdit">
                                          <ion-thumbnail slot="start">
                                            <ion-img [src]="updated_Suivi.img_culture"></ion-img>
                                          </ion-thumbnail>
                                        </span>
                                      </td>
                                    </ng-container>  
                                    <!-- New Image culture de semis Column -->
                                    <ng-container matColumnDef="new_img_cult">
                                      <th mat-header-cell *matHeaderCellDef> 
                                        <span>
                                          <ion-thumbnail slot="start">
                                            <ion-img [src]="updated_Suivi.img_culture"></ion-img>
                                          </ion-thumbnail>
                                        </span>
                                      </th>
                                    </ng-container>
                        
                                    <!-- Estimation  Column -->
                                    <ng-container matColumnDef="estimation">
                                      <th mat-header-cell *matHeaderCellDef> EX </th>
                                      <td mat-cell *matCellDef="let row; let i = index"> 
                                        <span *ngIf="!isRowSvSgEdit || (isRowSvSgEdit && indexSg != i && indexRowEditMepSg == ind_mep) || (indexRowEditMepSg != ind_mep && isRowSvSgEdit)">
                                          {{row.ex}}
                                        </span>
                                        <span *ngIf="indexSg == i && indexRowEditMepSg == ind_mep && isRowSvSgEdit">
                                          {{updated_Suivi.estimation}}
                                        </span>
                                      </td>
                                    </ng-container> 
                                    <!--New Estimation  Column -->
                                    <ng-container matColumnDef="new_estimation">
                                      <th mat-header-cell *matHeaderCellDef>  
                                        <span>
                                          {{updated_Suivi.estimation}}
                                        </span>
                                      </th>
                                    </ng-container>      
                                    
                                    <!-- New action Responsable Column -->
                                    <ng-container matColumnDef="new_action">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <a (click)="onSaveAddSuivi({src: 'sv-sg', row_mep: element_mep})">Done</a> |
                                        <a (click)="onCancelAddSuivi('sv-sg')">Cancel</a>
                                      </th>
                                    </ng-container>  
                                    
                                    <!-- action Column -->
                                    <ng-container matColumnDef="action">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <button mat-flat-button class="btn-info btn-dimension" (click)="onUpdateSuivi({action: 'add', src: 'mep-sg', row_mep:  element_mep, index_mep: ind_mep})" [disabled]="isAddSuiviSg || isRowSvSgEdit || isAddSuiviMv || isRowSvMvEdit || isAddSuiviPa || isRowSvPaEdit">Ajouter</button>
                                      </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="indexSg == i && indexRowEditMepSg == ind_mep && isRowSvSgEdit">
                                          <div class="child-btn" fxLayout="row">
                                            <div class="child-row1">
                                              <button mat-raised-button (click)="onCancelEditSuivi('sv-sg')" color="danger">Annuller</button>
                                            </div>
                                            <div class="child-row1">
                                              <button mat-raised-button (click)="onSaveEditSuivi({src: 'sv-sg', data: row})" color="primary">modifier</button>
                                            </div>
                                          </div>
                                        </span>
                                        <span *ngIf="!isRowSvSgEdit && !isAddSuiviSg && !isAddSuiviMv && !isRowSvMvEdit && !isAddSuiviPa && !isRowSvPaEdit">
                                          <button mat-flat-button class="btn-info btn-dimension" (click)="onUpdateSuivi({action: 'edit', src: 'mep-sg', row_mep: element_mep, row_suivi: row, index_mep_suivi: i, index_mep: ind_mep})">Editer</button>
                                        </span>
                                      </td>
                                    </ng-container>
                        
                                    <tr mat-header-row *matHeaderRowDef="displayedColumnsSuiviSg; sticky: true"></tr>
                                    <tr [hidden]="(isAddSuiviSg && indexRowEditMepSg != ind_mep) ||  !isAddSuiviSg" mat-header-row *matHeaderRowDef="displayedColumnsAddSuiviSg" class="second-header-row"></tr>
                                    <tr mat-row *matRowDef="let row; columns: displayedColumnsSuiviSg;"></tr>
                                
                                    <!-- Row shown when there is no matching data. -->
                                    <tr class="mat-row" *matNoDataRow>
                                      <td class="mat-cell" colspan="14">Aucun enregistrement"</td>
                                    </tr>
                                  </table>
                                </div>
                                <div class="row sv-element-detail-vide" [@detailExpand]="!isUpdated && element_mep.isExpanded && element_mep.suivi_Mep.length == 0? 'expanded' : 'collapsed'">
                                  <div mat-line>Aucun suivi</div>
                                </div>
                    
                              </td>
                            </ng-container>
                
                            <tr mat-header-row *matHeaderRowDef="displayedColumnsMepSg; sticky: true"></tr>
                            <tr [hidden]="!isAddMepSg" mat-header-row *matHeaderRowDef="displayedColumnsAddMepSg; sticky: true"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumnsMepSg;" class="sv-element-row hg-element-row" [class.sv-expanded-row]="row.isExpanded" [class.sv-row-vide]="row.suivi_Mep.length == 0"></tr>
                            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
                        
                            <!-- Row shown when there is no matching data. -->
                            <tr class="mat-row" *matNoDataRow>
                              <td class="mat-cell" colspan="14">Aucun enregistrement"</td>
                            </tr>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </ion-accordion>
              <!--Plants d'arbre-->
              <ion-accordion value="pa">
                <ion-item slot="header" class="level1">
                  <ion-label>Plants d'arbes</ion-label>
                </ion-item>

                <div slot="content">
                  <div class="flex-container width100" fxLayout="column" style="padding-left: 5px;">
                    <!--Column Bouton-->
                    <div class="child-column" fxLayout="row">
                      <div class="child-row">
                        <button mat-raised-button (click)="toggleTableRows({src: 'mep-pa'})" color="primary">Tout afficher</button>
                      </div>
                      <div class="child-row">
                        <button mat-raised-button (click)="onExport('mep-pa')" *ngIf="!isUpdated" [disabled]="src_MepPa.length == 0">Exporter</button>
                      </div>
                      <div class="child-row">
                        <button mat-raised-button (click)="onAdd('mep-pa')" *ngIf="isUpdated" [disabled]="isRowMepSgEdit || isAddMepSg || isRowMepPaEdit || isAddMepPa || isAddMepMv || isRowMepMvEdit">Ajouter</button>
                      </div>
                    </div>
                    <!--Table modifier-->
                    <div class="child-column">
                      <div class="container-matTab mat-elevation-z8">
                        <div class="table-container">
                          <table mat-table [dataSource]="dataSourceMepPa" multiTemplateDataRows>
    
                            <!-- Annee Column -->
                            <ng-container matColumnDef="annee">
                              <th mat-header-cell *matHeaderCellDef> Annee </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.annee_du}} 
                                </span>
                                <span *ngIf="indexRowEditMepPa == i  && isRowMepPaEdit">
                                  {{ update_mep.annee_du }} 
                                </span>
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="new_annee">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.annee_du }} </th>
                            </ng-container>               
                  
                            <!-- Bloc Column -->
                            <ng-container matColumnDef="bloc">
                              <th mat-header-cell *matHeaderCellDef> Bloc </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">  
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.nom_bl}}
                                </span>
                                <span *ngIf="indexRowEditMepPa == i  && isRowMepPaEdit">
                                  {{ update_mep.nom_bloc }} 
                                </span>
                              </td>
                            </ng-container>  
                            <ng-container matColumnDef="new_bloc">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_bloc }} </th>
                            </ng-container>            
                  
                            <!-- Parcelle Column -->
                            <ng-container matColumnDef="parcelle">
                              <th mat-header-cell *matHeaderCellDef> Code_parce </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.id_parce}}
                                </span>
                                <span *ngIf="indexRowEditMepPa == i  && isRowMepPaEdit">
                                  {{ update_mep.id_parce }} 
                                </span>
                              </td>
                            </ng-container>    
                            <ng-container matColumnDef="new_parcelle">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.id_parce }} </th>
                            </ng-container>            
                  
                            <!-- code_benef Column -->
                            <ng-container matColumnDef="code_benef">
                              <th mat-header-cell *matHeaderCellDef> code_benef </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.code_benef_bl}} 
                                </span>
                                <span *ngIf="indexRowEditMepPa == i  && isRowMepPaEdit">
                                  {{ update_mep.id_benef }} 
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_code_benef">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.id_benef }} </th>
                            </ng-container>                
                  
                            <!-- nom_benef Column -->
                            <ng-container matColumnDef="nom_benef">
                              <th mat-header-cell *matHeaderCellDef> Nom </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.nom}} {{row.prenom}} 
                                </span>
                                <span *ngIf="indexRowEditMepPa == i  && isRowMepPaEdit">
                                  {{ update_mep.nom_benef }} 
                                </span>
                              </td>
                            </ng-container>  
                            <ng-container matColumnDef="new_nom_benef">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_benef }} </th>
                            </ng-container>               
                  
                            <!-- qsa Column -->
                            <ng-container matColumnDef="ddp">
                              <th mat-header-cell *matHeaderCellDef> DDP </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.ddp}} 
                                </span>
                                <span *ngIf="indexRowEditMepPa == i  && isRowMepPaEdit">
                                  {{ update_mep.ddp }} 
                                </span>
                              </td>
                            </ng-container>   
                            <ng-container matColumnDef="new_ddp">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.ddp }} </th>
                            </ng-container>

                            <!-- espece Column -->
                            <ng-container matColumnDef="espece">
                              <th mat-header-cell *matHeaderCellDef> Espece </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.nom_espece}} 
                                </span>
                                <span *ngIf="indexRowEditMepPa == i  && isRowMepPaEdit">
                                  {{ update_mep.nom_espece }} 
                                </span>
                              </td>
                            </ng-container>   
                            <ng-container matColumnDef="new_espece">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_espece }} </th>
                            </ng-container>          
                  
                            <!-- quantite Obtenu Column -->
                            <ng-container matColumnDef="qo">
                              <th mat-header-cell *matHeaderCellDef> QO </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.qso}}
                                </span> 
                                <span *ngIf="indexRowEditMepPa == i  && isRowMepPaEdit">
                                  {{ update_mep.qso }} 
                                </span>
                              </td>
                            </ng-container>  
                            <ng-container matColumnDef="new_qo">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.qso }} </th>
                            </ng-container>   
                            
                            <!-- Date de distribution Column -->
                            <ng-container matColumnDef="dt_dist">
                              <th mat-header-cell *matHeaderCellDef> dt_distribution </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">  
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.dt_distribution}}
                                </span>
                                <span *ngIf="indexRowEditMepPa == i && isRowMepPaEdit">
                                  {{ update_mep.dt_distribution }}
                                </span>
                              </td>
                            </ng-container>     
                            <ng-container matColumnDef="new_dt_dist">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.dt_distribution }} </th>
                            </ng-container>  
                  
                            <!-- Date de semis Column -->
                            <ng-container matColumnDef="dt_mep">
                              <th mat-header-cell *matHeaderCellDef> dt_mep </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">  
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.dds}}
                                </span>
                                <span *ngIf="indexRowEditMepPa == i && isRowMepPaEdit">
                                  {{ update_mep.dds }}
                                </span>
                              </td>
                            </ng-container>     
                            <ng-container matColumnDef="new_dt_mep">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.dds }} </th>
                            </ng-container>              
                
                            <!-- nbre_ligne  Column -->
                            <ng-container matColumnDef="nbre_ligne">
                              <th mat-header-cell *matHeaderCellDef> nbre_ligne </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.nbre_ligne}}
                                </span>
                                <span *ngIf="indexRowEditMepPa == i && isRowMepPaEdit">
                                  {{ update_mep.nbre_ligne }}
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_nbre_ligne">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nbre_ligne }} </th>
                            </ng-container>

                            <!-- long_ligne  Column -->
                            <ng-container matColumnDef="long_ligne">
                              <th mat-header-cell *matHeaderCellDef> long_ligne </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepPaEdit || indexRowEditMepPa != i">
                                  {{row.long_ligne}}
                                </span>
                                <span *ngIf="indexRowEditMepPa == i && isRowMepPaEdit">
                                  {{ update_mep.long_ligne }}
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_long_ligne">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.long_ligne }} </th>
                            </ng-container>
                            
                            <!-- New action Column -->
                            <ng-container matColumnDef="new_action">
                              <th mat-header-cell *matHeaderCellDef>
                                <a (click)="onSaveAddMep('mep-pa')">Done</a> |
                                <a (click)="onCancelAddMep('mep-pa')">Cancel</a>
                              </th>
                            </ng-container>

                            <!-- action Column -->
                            <ng-container matColumnDef="action">
                              <th mat-header-cell *matHeaderCellDef> Action </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="indexRowEditMepPa == i  && isRowMepPaEdit && isUpdated">
                                  <a (click)="onClickSaveEdit({src: 'mep-pa', data: row})">modifier</a> |
                                  <a (click)="onClickCancelEdit('mep-pa')">Annuler</a>
                                </span>
                                <span *ngIf="!isUpdated">
                                  <button mat-flat-button class="btn-info btn-dimension" (click)="row.isExpanded = !row.isExpanded">suivi</button>
                                </span>
                                <div *ngIf="isUpdated && !isRowMepSgEdit && !isAddMepSg && !isRowMepPaEdit && !isAddMepPa && !isAddMepMv && !isRowMepMvEdit" fxLayout="row">
                                  <div class="child-row-btn">
                                    <a (click)="onEditElem({data: row, src: 'mep-pa', index: i})">Editer</a>
                                  </div>
                                  <div class="child-row-btn">
                                    <button mat-flat-button class="btn-info btn-dimension" (click)="onAddShowSuivi({src: 'mep-pa', index_: i})">Afficher</button>
                                  </div>
                                </div>
                              </td>
                            </ng-container>  
                            
                            <!-- Template for Suivi-->
                            <ng-container matColumnDef="expandedDetail">
                              <td mat-cell *matCellDef="let element_mep; dataIndex as ind_mep" [attr.colspan]="displayedColumnsMepSg.length">
                                <div class="row sv-element-detail" [@detailExpand]="element_mep.isExpanded && element_mep.suivi_Mep.length > 0 || isUpdated && element_mep.isExpanded? 'expanded' : 'collapsed'">
                                  <table mat-table [dataSource]="element_mep.suivi_Mep">
                  
                                    <!-- DDP Column -->
                                    <ng-container matColumnDef="ddp">
                                      <th mat-header-cell *matHeaderCellDef> DDP </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvPaEdit || (isRowSvPaEdit && indexPa != i && indexRowEditMepPa == ind_mep) || (indexRowEditMepPa != ind_mep && isRowSvPaEdit)">
                                          {{row.ddp | customDate}}
                                        </span>
                                        <span *ngIf="indexPa == i && indexRowEditMepPa == ind_mep && isRowSvPaEdit">
                                          {{updated_Suivi.ddp | customDate}}
                                        </span>
                                      </td>
                                    </ng-container> 
                                    <ng-container matColumnDef="new_ddp">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.ddp | customDate}}
                                        </span> 
                                      </th>
                                    </ng-container>               
                          
                                    <!-- ql Column -->
                                    <ng-container matColumnDef="ql">
                                      <th mat-header-cell *matHeaderCellDef> QL </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvPaEdit || (isRowSvPaEdit && indexPa != i && indexRowEditMepPa == ind_mep) || (indexRowEditMepPa != ind_mep && isRowSvPaEdit)">
                                          {{row.ql}}
                                        </span>
                                        <span *ngIf="indexPa == i && indexRowEditMepPa == ind_mep && isRowSvPaEdit">
                                          {{updated_Suivi.ql}}
                                        </span>
                                      </td>
                                    </ng-container> 
                                    <ng-container matColumnDef="new_ql">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.ql}}
                                        </span>
                                      </th>
                                    </ng-container>
                                    
                                    <!-- Etat Cultural Column -->
                                    <ng-container matColumnDef="ec">
                                      <th mat-header-cell *matHeaderCellDef> Etat </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvPaEdit || (isRowSvPaEdit && indexPa != i && indexRowEditMepPa == ind_mep) || (indexRowEditMepPa != ind_mep && isRowSvPaEdit)">
                                          {{row.ec}}
                                        </span>
                                        <span *ngIf="indexPa == i && indexRowEditMepPa == ind_mep && isRowSvPaEdit">
                                          {{updated_Suivi.ec != null?updated_Suivi.ec.intitule:null}}
                                        </span>
                                      </td>
                                    </ng-container> 
                                    <!-- new Etat Cultural Column -->
                                    <ng-container matColumnDef="new_ec">
                                      <th mat-header-cell *matHeaderCellDef>  
                                        <span>
                                          {{updated_Suivi.ec != null?updated_Suivi.ec.intitule:null}}
                                        </span>
                                      </th>
                                    </ng-container>
                          
                                    <!-- Image culture Column -->
                                    <ng-container matColumnDef="img_cult">
                                      <th mat-header-cell *matHeaderCellDef> img_cult </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvPaEdit || (isRowSvPaEdit && indexPa != i && indexRowEditMepPa == ind_mep) || (indexRowEditMepPa != ind_mep && isRowSvPaEdit)">
                                          <ion-thumbnail slot="start">
                                            <ion-img [src]="row.img_cult"></ion-img>
                                          </ion-thumbnail>
                                        </span>
                                        <span *ngIf="indexPa == i && indexRowEditMepPa == ind_mep && isRowSvPaEdit">
                                          <ion-thumbnail slot="start">
                                            <ion-img [src]="updated_Suivi.img_culture"></ion-img>
                                          </ion-thumbnail>
                                        </span>
                                      </td>
                                    </ng-container>  
                                    <!-- New Image culture de semis Column -->
                                    <ng-container matColumnDef="new_img_cult">
                                      <th mat-header-cell *matHeaderCellDef> 
                                        <span>
                                          <ion-thumbnail slot="start">
                                            <ion-img [src]="updated_Suivi.img_culture"></ion-img>
                                          </ion-thumbnail>
                                        </span>
                                      </th>
                                    </ng-container>
  
                                    <!-- Nbre_Ligne Ligne Column -->
                                    <ng-container matColumnDef="nbre_ligne">
                                      <th mat-header-cell *matHeaderCellDef> nbre_ligne </th>
                                      <td mat-cell *matCellDef="let row; let i = index"> 
                                        <span *ngIf="!isRowSvPaEdit || (isRowSvPaEdit && indexPa != i && indexRowEditMepPa == ind_mep) || (indexRowEditMepPa != ind_mep && isRowSvPaEdit)">
                                          {{row.nbre_ligne}}
                                        </span>
                                        <span *ngIf="indexPa == i && indexRowEditMepPa == ind_mep && isRowSvPaEdit">
                                          {{updated_Suivi.nbre_ligne}}
                                        </span>
                                      </td>
                                    </ng-container>
                                    <ng-container matColumnDef="new_nbre_ligne">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.nbre_ligne}}
                                        </span>
                                      </th>
                                    </ng-container>  
                                    
                                    <!-- Huteur Ligne Column -->
                                    <ng-container matColumnDef="hauteur">
                                      <th mat-header-cell *matHeaderCellDef> Hauteur </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvPaEdit || (isRowSvPaEdit && indexPa != i && indexRowEditMepPa == ind_mep) || (indexRowEditMepPa != ind_mep && isRowSvPaEdit)">
                                          {{row.hauteur}}
                                        </span>
                                        <span *ngIf="indexPa == i && indexRowEditMepPa == ind_mep && isRowSvPaEdit">
                                         {{updated_Suivi.hauteur}}
                                        </span>
                                      </td>
                                    </ng-container>
                                    <ng-container matColumnDef="new_hauteur">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.hauteur}}
                                        </span>
                                      </th>
                                    </ng-container>
  
                                    <!-- QR Column -->
                                    <ng-container matColumnDef="qr">
                                      <th mat-header-cell *matHeaderCellDef> QR </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvPaEdit || (isRowSvPaEdit && indexPa != i && indexRowEditMepPa == ind_mep) || (indexRowEditMepPa != ind_mep && isRowSvPaEdit)">
                                          {{row.qr}} 
                                        </span>
                                        <span *ngIf="indexPa == i && indexRowEditMepPa == ind_mep && isRowSvPaEdit">
                                          {{updated_Suivi.qr}}
                                        </span>
                                      </td>
                                    </ng-container>
                                    <!-- Image culture de semis Column -->
                                    <ng-container matColumnDef="new_qr">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.qr}}
                                        </span>
                                      </th>
                                    </ng-container>   
                                    
                                    <!-- New action Responsable Column -->
                                    <ng-container matColumnDef="new_action">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <a (click)="onSaveAddSuivi({src: 'sv-pa', row_mep: element_mep})">Done</a> |
                                        <a (click)="onCancelAddSuivi('sv-pa')">Cancel</a>
                                      </th>
                                    </ng-container>
  
                                    <!-- action Column -->
                                    <ng-container matColumnDef="action">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <button mat-flat-button class="btn-info btn-dimension" (click)="onUpdateSuivi({action: 'add', src: 'mep-pa', row_mep:  element_mep, index_mep: ind_mep})" [disabled]="isAddSuiviSg || isRowSvSgEdit || isAddSuiviMv || isRowSvMvEdit || isAddSuiviPa || isRowSvPaEdit">Ajouter</button>
                                      </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="indexPa == i && indexRowEditMepPa == ind_mep && isRowSvPaEdit">
                                          <div class="child-btn" fxLayout="row">
                                            <div class="child-row1">
                                              <button mat-raised-button (click)="onCancelEditSuivi('sv-pa')" color="danger">Annuller</button>
                                            </div>
                                            <div class="child-row1">
                                              <button mat-raised-button (click)="onSaveEditSuivi({src: 'sv-pa', data: row})" color="primary">modifier</button>
                                            </div>
                                          </div>
                                        </span>
                                        <span *ngIf="!isRowSvSgEdit && !isAddSuiviSg && !isAddSuiviMv && !isRowSvMvEdit && !isAddSuiviPa && !isRowSvPaEdit">
                                          <button mat-flat-button class="btn-info btn-dimension" (click)="onUpdateSuivi({action: 'edit', src: 'mep-pa', row_mep: element_mep, row_suivi: row, index_mep_suivi: i, index_mep: ind_mep})">Editer</button>
                                        </span>
                                      </td>
                                    </ng-container>
                        
                                    <tr mat-header-row *matHeaderRowDef="displayedColumnsSuiviPa; sticky: true"></tr>
                                    <tr [hidden]="(isAddSuiviPa && indexRowEditMepPa != ind_mep) ||  !isAddSuiviPa" mat-header-row *matHeaderRowDef="displayedColumnsAddSuiviPa; sticky: true"></tr>
                                    <tr mat-row *matRowDef="let row; columns: displayedColumnsSuiviPa;"></tr>
                                
                                    <!-- Row shown when there is no matching data. -->
                                    <tr class="mat-row" *matNoDataRow>
                                      <td class="mat-cell" colspan="14">Aucun enregistrement"</td>
                                    </tr>
                                  </table>
                                </div>
                                <div class="row sv-element-detail-vide" [@detailExpand]="!isUpdated && element_mep.isExpanded && element_mep.suivi_Mep.length == 0? 'expanded' : 'collapsed'">
                                  <div mat-line>Aucun suivi</div>
                                </div>
                              </td>
                            </ng-container>
                
                            <tr mat-header-row *matHeaderRowDef="displayedColumnsMepPa; sticky: true"></tr>
                            <tr [hidden]="!isAddMepPa" mat-header-row *matHeaderRowDef="displayedColumnsAddMepPa; sticky: true"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumnsMepPa;" class="sv-element-row hg-element-row" [class.sv-expanded-row]="row.isExpanded" [class.sv-row-vide]="row.suivi_Mep.length == 0"></tr>
                            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
                        
                            <!-- Row shown when there is no matching data. -->
                            <tr class="mat-row" *matNoDataRow>
                              <td class="mat-cell" colspan="14">Aucun enregistrement"</td>
                            </tr>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </ion-accordion>
              <!--Materiels végetaux-->
              <ion-accordion value="mv">
                <ion-item slot="header" class="level1">
                  <ion-label>Materiels vegetaux</ion-label>
                </ion-item>

                <div slot="content">
                  <div class="flex-container width100" fxLayout="column" style="padding-left: 5px;">
                    <!--Column Bouton-->
                    <div class="child-column" fxLayout="row">
                      <div class="child-row">
                        <button mat-raised-button (click)="toggleTableRows({src: 'mep-mv'})" color="primary">Tout afficher</button>
                      </div>
                      <div class="child-row">
                        <button mat-raised-button (click)="onExport('mep-mv')" *ngIf="!isUpdated" [disabled]="src_MepMv.length == 0">Exporter</button>
                      </div>
                      <div class="child-row">
                        <button mat-raised-button (click)="onAdd('mep-mv')" *ngIf="isUpdated" [disabled]="isRowMepSgEdit || isAddMepSg || isRowMepPaEdit || isAddMepPa || isAddMepMv || isRowMepMvEdit">Ajouter</button>
                      </div>
                    </div>
                    <!--Table modifier-->
                    <div class="child-column">
                      <div class="container-matTab mat-elevation-z8">
                        <div class="table-container">
                          <table mat-table [dataSource]="dataSourceMepMv" multiTemplateDataRows>
    
                            <!-- Annee Column -->
                            <ng-container matColumnDef="annee">
                              <th mat-header-cell *matHeaderCellDef> Annee </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.annee_du}} 
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.annee_du }} 
                                </span>
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="new_annee">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.annee_du }} </th>
                            </ng-container>
                  
                            <!-- Saison Column -->
                            <ng-container matColumnDef="saison">
                              <th mat-header-cell *matHeaderCellDef> Saison </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.intitule}} 
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.nom_saison }} 
                                </span>
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="new_saison">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_saison }} </th>
                            </ng-container>   

                            <!-- Bloc Column -->
                            <ng-container matColumnDef="bloc">
                              <th mat-header-cell *matHeaderCellDef> Bloc </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">  
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.nom_bl}}
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.nom_bloc }} 
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_bloc">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_bloc }} </th>
                            </ng-container>             
                  
                            <!-- Parcelle Column -->
                            <ng-container matColumnDef="parcelle">
                              <th mat-header-cell *matHeaderCellDef> code_parce </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.id_parce}}
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.id_parce }} 
                                </span>
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="new_parcelle">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.id_parce }} </th>
                            </ng-container>            
                  
                            <!-- code_benef Column -->
                            <ng-container matColumnDef="code_benef">
                              <th mat-header-cell *matHeaderCellDef> code_benef </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.code_benef_bl}} 
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.id_benef }} 
                                </span>
                              </td>
                            </ng-container>   
                            <ng-container matColumnDef="new_code_benef">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.id_benef }} </th>
                            </ng-container>              
                  
                            <!-- nom_benef Column -->
                            <ng-container matColumnDef="nom_benef">
                              <th mat-header-cell *matHeaderCellDef> Nom </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.nom}} {{row.prenom}}
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.nom_benef }} 
                                </span>
                              </td>
                            </ng-container>  
                            <ng-container matColumnDef="new_nom_benef">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_benef }} </th>
                            </ng-container>               
                  
                            <!-- qsa Column -->
                            <ng-container matColumnDef="ddp">
                              <th mat-header-cell *matHeaderCellDef> DDP </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.ddp}} 
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.ddp }} 
                                </span>
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="new_ddp">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.ddp }} </th>
                            </ng-container>     

                            <!-- espece Column -->
                            <ng-container matColumnDef="espece">
                              <th mat-header-cell *matHeaderCellDef> Espece </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.nom_espece}} 
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.nom_espece }} 
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_espece">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nom_espece }} </th>
                            </ng-container> 
                  
                            <!-- qso Column -->
                            <ng-container matColumnDef="qso">
                              <th mat-header-cell *matHeaderCellDef> QSO </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.qso}} 
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.qso }} 
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_qso">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.qso }} </th>
                            </ng-container>
                                           
                  
                            <!-- Date de semis Column -->
                            <ng-container matColumnDef="dt_mep">
                              <th mat-header-cell *matHeaderCellDef> dt_mep </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">  
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.dds}}
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.dds }} 
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_dt_mep">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.dds }} </th>
                            </ng-container>              
                
                            <!-- sfce  Column -->
                            <ng-container matColumnDef="sfce_embl">
                              <th mat-header-cell *matHeaderCellDef> sfce_embl </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.sfce}}
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.sfce }} 
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_sfce_embl">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.sfce }} </th>
                            </ng-container>

                            <!-- nbre_ligne  Column -->
                            <ng-container matColumnDef="nbre_ligne">
                              <th mat-header-cell *matHeaderCellDef> nbre_ligne </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.nbre_ligne}}
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.nbre_ligne }}
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_nbre_ligne">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.nbre_ligne }} </th>
                            </ng-container>

                            <!-- nbre_ligne  Column -->
                            <ng-container matColumnDef="long_ligne">
                              <th mat-header-cell *matHeaderCellDef> long_ligne </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepMvEdit || indexRowEditMepMv != i">
                                  {{row.long_ligne}}
                                </span>
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit">
                                  {{ update_mep.long_ligne }}
                                </span>
                              </td>
                            </ng-container> 
                            <ng-container matColumnDef="new_long_ligne">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.long_ligne }} </th>
                            </ng-container>
                            
                            <!-- sc Column -->
                            <ng-container matColumnDef="sc">
                              <th mat-header-cell *matHeaderCellDef> sc </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.sc}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.sc }} 
                                </span>
                              </td>
                            </ng-container>
                            <ng-container matColumnDef="new_sc">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.sc }} </th>
                            </ng-container>

                            <!-- culture associé Column -->
                            <ng-container matColumnDef="ea">
                              <th mat-header-cell *matHeaderCellDef> EA </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex"> 
                                <span  *ngIf="!isRowMepSgEdit || indexRowEditMepSg != i">
                                  {{row.ea}}
                                </span>
                                <span *ngIf="indexRowEditMepSg == i  && isRowMepSgEdit">
                                  {{ update_mep.ea }} 
                                </span>
                              </td>
                            </ng-container>
                            <!-- New culture associé Column -->
                            <ng-container matColumnDef="new_ea">
                              <th mat-header-cell *matHeaderCellDef> {{ update_mep.ea }} </th>
                            </ng-container>

                            <!-- New action Column -->
                            <ng-container matColumnDef="new_action">
                              <th mat-header-cell *matHeaderCellDef>
                                <a (click)="onSaveAddMep('mep-mv')">Done</a> |
                                <a (click)="onCancelAddMep('mep-mv')">Cancel</a>
                              </th>
                            </ng-container>

                            <!-- action Column -->
                            <ng-container matColumnDef="action">
                              <th mat-header-cell *matHeaderCellDef> Action </th>
                              <td mat-cell *matCellDef="let row; let i = dataIndex">
                                <span *ngIf="indexRowEditMepMv == i  && isRowMepMvEdit && isUpdated">
                                  <a (click)="onClickSaveEdit({src: 'mep-mv', data: row})">modifier</a> |
                                  <a (click)="onClickCancelEdit('mep-mv')">Annuler</a>
                                </span>
                                <span *ngIf="!isUpdated">
                                  <button mat-flat-button class="btn-info btn-dimension" (click)="row.isExpanded = !row.isExpanded">suivi</button>
                                </span>
                                <div *ngIf="isUpdated && !isRowMepSgEdit && !isAddMepSg && !isRowMepPaEdit && !isAddMepPa && !isAddMepMv && !isRowMepMvEdit" fxLayout="row">
                                  <div class="child-row-btn">
                                    <a (click)="onEditElem({data: row, src: 'mep-mv', index: i})">Edit</a>
                                  </div>
                                  <div class="child-row-btn">
                                    <button mat-flat-button class="btn-info btn-dimension" (click)="onAddShowSuivi({src: 'mep-mv', index_: i})">Afficher</button>
                                  </div>
                                </div>
                              </td>
                            </ng-container>

                            <!-- Template for Suivi-->
                            <ng-container matColumnDef="expandedDetail">
                              <td mat-cell *matCellDef="let element_mep; dataIndex as ind_mep" [attr.colspan]="displayedColumnsMepSg.length">
                    
                                <div class="row sv-element-detail" [@detailExpand]="element_mep.isExpanded && element_mep.suivi_Mep.length > 0 || isUpdated && element_mep.isExpanded? 'expanded' : 'collapsed'">
                                  <table mat-table [dataSource]="element_mep.suivi_Mep">            
                  
                                    <!-- DDP Column -->
                                    <ng-container matColumnDef="ddp">
                                      <th mat-header-cell *matHeaderCellDef> DDP </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvMvEdit || (isRowSvMvEdit && indexMv != i && indexRowEditMepMv == ind_mep) || (indexRowEditMepMv != ind_mep && isRowSvMvEdit)">
                                          {{row.ddp | customDate}}
                                        </span>
                                        <span *ngIf="indexMv == i && indexRowEditMepMv == ind_mep && isRowSvMvEdit">
                                          {{updated_Suivi.ddp | customDate}}
                                        </span>
                                      </td>
                                    </ng-container>   
                                    <ng-container matColumnDef="new_ddp">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.ddp | customDate}}
                                        </span> 
                                      </th>
                                    </ng-container>               
                          
                                    <!-- nbre_pieds Column -->
                                    <ng-container matColumnDef="nbre_pieds">
                                      <th mat-header-cell *matHeaderCellDef> Nbre_pieds </th>
                                      <td mat-cell *matCellDef="let row; let i = index">
                                        <span *ngIf="!isRowSvMvEdit || (isRowSvMvEdit && indexMv != i && indexRowEditMepMv == ind_mep) || (indexRowEditMepMv != ind_mep && isRowSvMvEdit)">
                                          {{row.nbre_pied}}
                                        </span>
                                        <span *ngIf="indexMv == i && indexRowEditMepMv == ind_mep && isRowSvMvEdit">
                                          {{updated_Suivi.nbre_pied}}
                                        </span>
                                      </td>
                                    </ng-container>  
                                    <ng-container matColumnDef="new_nbre_pieds">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.nbre_pied}}
                                        </span>
                                      </th>
                                    </ng-container>    
                                    
                                    <!-- Longueur Ligne Column -->
                                    <ng-container matColumnDef="long_ligne">
                                      <th mat-header-cell *matHeaderCellDef> Long_ligne </th>
                                      <td mat-cell *matCellDef="let row; let i = index"> 
                                        <span *ngIf="!isRowSvMvEdit || (isRowSvMvEdit && indexMv != i && indexRowEditMepMv == ind_mep) || (indexRowEditMepMv != ind_mep && isRowSvMvEdit)">
                                          {{row.long_ligne}}
                                        </span>
                                        <span *ngIf="indexMv == i && indexRowEditMepMv == ind_mep && isRowSvMvEdit">
                                          {{updated_Suivi.long_ligne}}
                                        </span>
                                      </td>
                                    </ng-container>  
                                    <ng-container matColumnDef="new_long_ligne">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.long_ligne}}
                                        </span>
                                      </th>
                                    </ng-container>
                                    
                                    <!-- Nbre_Ligne Ligne Column -->
                                    <ng-container matColumnDef="nbre_ligne">
                                      <th mat-header-cell *matHeaderCellDef> nbre_ligne </th>
                                      <td mat-cell *matCellDef="let row; let i = index"> 
                                        <span *ngIf="!isRowSvMvEdit || (isRowSvMvEdit && indexMv != i && indexRowEditMepMv == ind_mep) || (indexRowEditMepMv != ind_mep && isRowSvMvEdit)">
                                          {{row.nbre_ligne}}
                                        </span>
                                        <span *ngIf="indexMv == i && indexRowEditMepMv == ind_mep && isRowSvMvEdit">
                                          {{updated_Suivi.nbre_ligne}}
                                        </span>
                                      </td>
                                    </ng-container>
                                    <ng-container matColumnDef="new_nbre_ligne">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.nbre_ligne}}
                                        </span>
                                      </th>
                                    </ng-container>
                          
                                    <!-- Estimation culture Column -->
                                    <ng-container matColumnDef="estimation">
                                      <th mat-header-cell *matHeaderCellDef>EX</th>
                                      <td mat-cell *matCellDef="let row; let i = index">  
                                        <span *ngIf="!isRowSvMvEdit || (isRowSvMvEdit && indexMv != i && indexRowEditMepMv == ind_mep) || (indexRowEditMepMv != ind_mep && isRowSvMvEdit)">
                                          {{row.ex}}
                                        </span>
                                        <span *ngIf="indexMv == i && indexRowEditMepMv == ind_mep && isRowSvMvEdit">
                                          {{updated_Suivi.estimation}}
                                        </span>
                                      </td>
                                    </ng-container>   
                                    <ng-container matColumnDef="new_estimation">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <span>
                                          {{updated_Suivi.estimation}}
                                        </span>
                                      </th>
                                    </ng-container> 
                                    
                                     <!-- New action Responsable Column -->
                                     <ng-container matColumnDef="new_action">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <a (click)="onSaveAddSuivi({src: 'sv-mv', row_mep: element_mep})">Done</a> |
                                        <a (click)="onCancelAddSuivi('sv-mv')">Cancel</a>
                                      </th>
                                    </ng-container>
  
                                    <!-- action Column -->
                                    <ng-container matColumnDef="action">
                                      <th mat-header-cell *matHeaderCellDef>
                                        <button mat-flat-button class="btn-info btn-dimension" (click)="onUpdateSuivi({action: 'add', src: 'mep-mv', row_mep:  element_mep, index_mep: ind_mep})" [disabled]="isAddSuiviSg || isRowSvSgEdit || isAddSuiviMv || isRowSvMvEdit || isAddSuiviPa || isRowSvPaEdit">Ajouter</button>
                                      </th>
                                      <td mat-cell *matCellDef="let row; let i = index"> 
                                        <span *ngIf="indexMv == i && indexRowEditMepMv == ind_mep && isRowSvMvEdit">
                                          <div class="child-btn" fxLayout="row">
                                            <div class="child-row1">
                                              <button mat-raised-button (click)="onCancelEditSuivi('sv-mv')" color="danger">Annuller</button>
                                            </div>
                                            <div class="child-row1">
                                              <button mat-raised-button (click)="onSaveEditSuivi({src: 'sv-mv', data: row})" color="primary">modifier</button>
                                            </div>
                                          </div>
                                        </span>
                                        <span *ngIf="!isRowSvSgEdit && !isAddSuiviSg && !isAddSuiviMv && !isRowSvMvEdit && !isAddSuiviPa && !isRowSvPaEdit">
                                          <button mat-flat-button class="btn-info btn-dimension" (click)="onUpdateSuivi({action: 'edit', src: 'mep-mv', row_mep: element_mep, row_suivi: row, index_mep_suivi: i, index_mep: ind_mep})">Editer</button>
                                        </span>
                                      </td>
                                    </ng-container>
                        
                                    <tr mat-header-row *matHeaderRowDef="displayedColumnsSuiviMv; sticky: true"></tr>
                                    <tr [hidden]="(isAddSuiviMv && indexRowEditMepMv != ind_mep) ||  !isAddSuiviMv" mat-header-row *matHeaderRowDef="displayedColumnsAddSuiviMv"></tr>
                                    <tr mat-row *matRowDef="let row; columns: displayedColumnsSuiviMv;"></tr>
                                
                                    <!-- Row shown when there is no matching data. -->
                                    <tr class="mat-row" *matNoDataRow>
                                      <td class="mat-cell" colspan="14">Aucun enregistrement"</td>
                                    </tr>
                                  </table>                                        
                                </div>
                                <div class="row sv-element-detail-vide" [@detailExpand]="!isUpdated && element_mep.isExpanded && element_mep.suivi_Mep.length == 0? 'expanded' : 'collapsed'">
                                  <div mat-line>Aucun suivi</div>
                                </div>
                    
                              </td>
                            </ng-container>
                
                            <tr mat-header-row *matHeaderRowDef="displayedColumnsMepMv; sticky: true"></tr>
                            <tr [hidden]="!isAddMepMv" mat-header-row *matHeaderRowDef="displayedColumnsAddMepMv; sticky: true"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumnsMepMv;" class="sv-element-row hg-element-row" [class.sv-expanded-row]="row.isExpanded" [class.sv-row-vide]="row.suivi_Mep.length == 0"></tr>
                            <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
                        
                            <!-- Row shown when there is no matching data. -->
                            <tr class="mat-row" *matNoDataRow>
                              <td class="mat-cell" colspan="14">Aucun enregistrement"</td>
                            </tr>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </ion-accordion>
            </ion-accordion-group>
          </div>
        </div>
      </div>
    </mat-tab>
    <mat-tab label="suivi">
      <div class="contonaire-content-flex">
        <ion-accordion-group mode="ios" [multiple]="true" value="sg_">
          <!--Suivi semences en grains-->
          <ion-accordion value="sg_">
            <ion-item slot="header" class="level1">
              <ion-label>Suivi Semences en grains</ion-label>
            </ion-item>

            <div slot="content">
              <div class="flex-container width100" fxLayout="column" style="padding-left: 5px;">
                <!--Column Bouton-->
                <div class="child-column">
                  <ion-button (click)="onExport('sv-sg')" [disabled]="src_AllSvSg.length == 0">Exporte</ion-button>
                </div>
                <!--Table modifier-->
                <div class="child-column">
                  <div class="container-matTab mat-elevation-z8">
                    <div class="table-container">
                      <table mat-table [dataSource]="dataSourceAllSuiviSg">

                        <!-- Code Column -->
                        <ng-container matColumnDef="code_suivi">
                          <th mat-header-cell *matHeaderCellDef> Code sv </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.code_sv}}
                            </span>
                          </td>
                        </ng-container>
              
                        <!-- Bloc Column -->
                        <ng-container matColumnDef="bloc">
                          <th mat-header-cell *matHeaderCellDef> Bloc </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.bloc}} 
                            </span>
                          </td>
                        </ng-container>            
              
                        <!-- Parcelle Column -->
                        <ng-container matColumnDef="parcelle">
                          <th mat-header-cell *matHeaderCellDef> Parcelle </th>
                          <td mat-cell *matCellDef="let row; let i = index">  
                            <span>
                              {{row.id_parce}}
                            </span>
                          </td>
                        </ng-container>          
              
                        <!-- Code beneficiaire Column -->
                        <ng-container matColumnDef="code_benef">
                          <th mat-header-cell *matHeaderCellDef> Code benef </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.code_benef_bl}}
                            </span>
                          </td>
                        </ng-container>          
              
                        <!-- Nom Column -->
                        <ng-container matColumnDef="nom">
                          <th mat-header-cell *matHeaderCellDef> Nom </th>
                          <td mat-cell *matCellDef="let row; let i = index">
                            <span>
                              {{row.nom}} {{row.prenom}}
                            </span>
                          </td>
                        </ng-container>       
              
                        <!-- Variette Column -->
                        <ng-container matColumnDef="variette">
                          <th mat-header-cell *matHeaderCellDef> Variette </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.variette}}
                            </span>
                          </td>
                        </ng-container>              
              
                        <!-- QSO Column -->
                        <ng-container matColumnDef="qso">
                          <th mat-header-cell *matHeaderCellDef> QSO </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.qso}}
                            </span>
                          </td>
                        </ng-container>
                        
                        <!-- DDS Column -->
                        <ng-container matColumnDef="dds">
                          <th mat-header-cell *matHeaderCellDef> DDS </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.dds}} 
                            </span>
                          </td>
                        </ng-container>
              
                        <!-- sfce_emb Column -->
                        <ng-container matColumnDef="sfce_emb">
                          <th mat-header-cell *matHeaderCellDef> Sfce_emb </th>
                          <td mat-cell *matCellDef="let row; let i = index">
                            <span>
                              {{row.sfce}} 
                            </span>
                          </td>
                        </ng-container>              
              
                        <!-- System Cultural Column -->
                        <ng-container matColumnDef="sc">
                          <th mat-header-cell *matHeaderCellDef> SC </th>
                          <td mat-cell *matCellDef="let row; let i = index">  
                            <span>
                              {{row.mep_sc}}
                            </span>
                          </td>
                        </ng-container>              
            
                        <!-- DDP  Column -->
                        <ng-container matColumnDef="ddp">
                          <th mat-header-cell *matHeaderCellDef> DDP </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.ddp}}
                            </span>
                          </td>
                        </ng-container>            
            
                        <!-- STC Column -->
                        <ng-container matColumnDef="stc">
                          <th mat-header-cell *matHeaderCellDef> STC </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.stc}}
                            </span>
                          </td>
                        </ng-container>

                        <!-- Etat Column -->
                        <ng-container matColumnDef="ec">
                          <th mat-header-cell *matHeaderCellDef> Etat </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.ec}}
                            </span>
                          </td>
                        </ng-container>
                        
                        <!-- long_ligne Ligne Column -->
                        <ng-container matColumnDef="long_ligne">
                          <th mat-header-cell *matHeaderCellDef> Long_ligne </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.long_ligne}}
                            </span>
                          </td>
                        </ng-container>

                        <!-- Nombre Ligne Column -->
                        <ng-container matColumnDef="nbre_ligne">
                          <th mat-header-cell *matHeaderCellDef> Nbre_ligne </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.nbre_ligne}}
                            </span>
                          </td>
                        </ng-container>

                        <!-- IMG Column -->
                        <ng-container matColumnDef="img_cult">
                          <th mat-header-cell *matHeaderCellDef> Img_cult </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              <ion-thumbnail slot="start">
                                <ion-img [src]="row.img_cult"></ion-img>
                              </ion-thumbnail>
                            </span>
                          </td>
                        </ng-container>
            
                        <!-- Ex Column -->
                        <ng-container matColumnDef="ex">
                          <th mat-header-cell *matHeaderCellDef> EX </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.ex}}
                            </span>
                          </td>
                        </ng-container>
            
                        <tr mat-header-row *matHeaderRowDef="displayedColumnsAllSvSg; sticky: true"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumnsAllSvSg;"></tr>
                    
                        <!-- Row shown when there is no matching data. -->
                        <tr class="mat-row" *matNoDataRow>
                          <td class="mat-cell" colspan="14">Aucun enregistrement"</td>
                        </tr>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ion-accordion>
          <!--Suivi Plants d'arbre-->
          <ion-accordion value="pa_">
            <ion-item slot="header" class="level1">
              <ion-label>Suivi jeunes Plants</ion-label>
            </ion-item>

            <div slot="content">
              <div class="flex-container width100" fxLayout="column" style="padding-left: 5px;">
                <!--Column Bouton-->
                <div class="child-column">
                  <ion-button (click)="onExport('sv-pa')" *ngIf="!isUpdated" [disabled]="src_AllSvPa.length == 0">Exporte</ion-button>
                </div>
                <!--Table modifier-->
                <div class="child-column">
                  <div class="container-matTab mat-elevation-z8">
                    <div class="table-container">
                      <table mat-table [dataSource]="dataSourceAllSuiviPa">

                        <!-- Code Column -->
                        <ng-container matColumnDef="code_suivi">
                          <th mat-header-cell *matHeaderCellDef> Code sv </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.code_sv}}
                            </span>
                          </td>
                        </ng-container>
              
                        <!-- Bloc Column -->
                        <ng-container matColumnDef="bloc">
                          <th mat-header-cell *matHeaderCellDef> Bloc </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.bloc}} 
                            </span>
                          </td>
                        </ng-container>            
              
                        <!-- Parcelle Column -->
                        <ng-container matColumnDef="parcelle">
                          <th mat-header-cell *matHeaderCellDef> Parcelle </th>
                          <td mat-cell *matCellDef="let row; let i = index">  
                            <span>
                              {{row.id_parce}}
                            </span>
                          </td>
                        </ng-container>          
              
                        <!-- Code beneficiaire Column -->
                        <ng-container matColumnDef="code_benef">
                          <th mat-header-cell *matHeaderCellDef> Code benef </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.code_benef_bl}}
                            </span>
                          </td>
                        </ng-container>          
              
                        <!-- Nom Column -->
                        <ng-container matColumnDef="nom">
                          <th mat-header-cell *matHeaderCellDef> Nom </th>
                          <td mat-cell *matCellDef="let row; let i = index">
                            <span>
                              {{row.nom}} {{row.prenom}}
                            </span>
                          </td>
                        </ng-container> 
                        
                         <!-- DDP  Column -->
                        <ng-container matColumnDef="ddp">
                          <th mat-header-cell *matHeaderCellDef> DDP </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.ddp}}
                            </span>
                          </td>
                        </ng-container> 
              
                        <!-- Variette Column -->
                        <ng-container matColumnDef="espece">
                          <th mat-header-cell *matHeaderCellDef> Espece </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.espece}}
                            </span>
                          </td>
                        </ng-container>              
              
                        <!-- QSO Column -->
                        <ng-container matColumnDef="qso">
                          <th mat-header-cell *matHeaderCellDef> QO </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.qso}}
                            </span>
                          </td>
                        </ng-container>
                        
                        <!-- DDS Column -->
                        <ng-container matColumnDef="dds">
                          <th mat-header-cell *matHeaderCellDef> Dt_MEP </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.dds}} 
                            </span>
                          </td>
                        </ng-container>
              
                        <!-- sfce_emb Column -->
                        <ng-container matColumnDef="sfce_emb">
                          <th mat-header-cell *matHeaderCellDef> Sfce_emb </th>
                          <td mat-cell *matCellDef="let row; let i = index">
                            <span>
                              {{row.sfce}} 
                            </span>
                          </td>
                        </ng-container>              
                        
                        <!-- long_ligne Ligne Column -->
                        <ng-container matColumnDef="ql">
                          <th mat-header-cell *matHeaderCellDef> QL </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.ql}}
                            </span>
                          </td>
                        </ng-container>

                        <!-- EC Column -->
                        <ng-container matColumnDef="ec">
                          <th mat-header-cell *matHeaderCellDef> Etat </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.ec}}
                            </span>
                          </td>
                        </ng-container>
                        
                        <!-- nbre_ligne Column -->
                        <ng-container matColumnDef="nbre_ligne">
                          <th mat-header-cell *matHeaderCellDef> nb_Ligne </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.nbre_ligne}}
                            </span>
                          </td>
                        </ng-container>

                        <!-- nbre_ligne Column -->
                        <ng-container matColumnDef="hauteur">
                          <th mat-header-cell *matHeaderCellDef> Hauteur </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.hauteur}}
                            </span>
                          </td>
                        </ng-container>

                        <!-- nbre_ligne Column -->
                        <ng-container matColumnDef="img_cult">
                          <th mat-header-cell *matHeaderCellDef> Img_cult </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              <ion-thumbnail slot="start">
                                <ion-img [src]="row.img_cult"></ion-img>
                              </ion-thumbnail>
                            </span>
                          </td>
                        </ng-container>

                        <!-- QR Column -->
                        <ng-container matColumnDef="qr">
                          <th mat-header-cell *matHeaderCellDef> QR </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.qr}}
                            </span>
                          </td>
                        </ng-container>
            
                        <tr mat-header-row *matHeaderRowDef="displayedColumnsAllSvPa; sticky: true"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumnsAllSvPa;"></tr>
                    
                        <!-- Row shown when there is no matching data. -->
                        <tr class="mat-row" *matNoDataRow>
                          <td class="mat-cell" colspan="14">Aucun enregistrement"</td>
                        </tr>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ion-accordion>
          <!--Suivi Materiels vegetals-->
          <ion-accordion value="mv_">
            <ion-item slot="header" class="level1">
              <ion-label>Suivi Materiels vegetals</ion-label>
            </ion-item>

            <div slot="content">
              <div class="flex-container width100" fxLayout="column" style="padding-left: 5px;">
                <!--Column Bouton-->
                <div class="child-column">
                  <ion-button (click)="onExport('sv-mv')" *ngIf="!isUpdated" [disabled]="src_AllSvMv.length == 0">Exporte</ion-button>
                </div>
                <!--Table modifier-->
                <div class="child-column">
                  <div class="container-matTab mat-elevation-z8">
                    <div class="table-container">
                      <table mat-table [dataSource]="dataSourceAllSuiviMv">

                        <!-- Code Column -->
                        <ng-container matColumnDef="code_suivi">
                          <th mat-header-cell *matHeaderCellDef> Code sv </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.code_sv}}
                            </span>
                          </td>
                        </ng-container>
              
                        <!-- Bloc Column -->
                        <ng-container matColumnDef="bloc">
                          <th mat-header-cell *matHeaderCellDef> Bloc </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.bloc}} 
                            </span>
                          </td>
                        </ng-container>            
              
                        <!-- Parcelle Column -->
                        <ng-container matColumnDef="parcelle">
                          <th mat-header-cell *matHeaderCellDef> Parcelle </th>
                          <td mat-cell *matCellDef="let row; let i = index">  
                            <span>
                              {{row.id_parce}}
                            </span>
                          </td>
                        </ng-container>          
              
                        <!-- Code beneficiaire Column -->
                        <ng-container matColumnDef="code_benef">
                          <th mat-header-cell *matHeaderCellDef> Code benef </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.code_benef_bl}}
                            </span>
                          </td>
                        </ng-container>          
              
                        <!-- Nom Column -->
                        <ng-container matColumnDef="nom">
                          <th mat-header-cell *matHeaderCellDef> Nom </th>
                          <td mat-cell *matCellDef="let row; let i = index">
                            <span>
                              {{row.nom}} {{row.prenom}}
                            </span>
                          </td>
                        </ng-container> 
                        
                         <!-- DDP  Column -->
                        <ng-container matColumnDef="ddp">
                          <th mat-header-cell *matHeaderCellDef> DDP </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.ddp}}
                            </span>
                          </td>
                        </ng-container> 
              
                        <!-- Variette Column -->
                        <ng-container matColumnDef="espece">
                          <th mat-header-cell *matHeaderCellDef> Espece </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.espece}}
                            </span>
                          </td>
                        </ng-container>              
              
                        <!-- QSO Column -->
                        <ng-container matColumnDef="qso">
                          <th mat-header-cell *matHeaderCellDef> QSO </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.qso}}
                            </span>
                          </td>
                        </ng-container>
                        
                        <!-- DDS Column -->
                        <ng-container matColumnDef="dds">
                          <th mat-header-cell *matHeaderCellDef> Dt_MEP </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.dds}} 
                            </span>
                          </td>
                        </ng-container>
              
                        <!-- sfce_emb Column -->
                        <ng-container matColumnDef="sfce_emb">
                          <th mat-header-cell *matHeaderCellDef> Sfce_emb </th>
                          <td mat-cell *matCellDef="let row; let i = index">
                            <span>
                              {{row.sfce}} 
                            </span>
                          </td>
                        </ng-container>              
              
                        <!-- System Cultural Column -->
                        <ng-container matColumnDef="sc">
                          <th mat-header-cell *matHeaderCellDef> SC </th>
                          <td mat-cell *matCellDef="let row; let i = index">  
                            <span>
                              {{row.mep_sc}}
                            </span>
                          </td>
                        </ng-container>
                        
                        <!-- Nombre pieds Column -->
                        <ng-container matColumnDef="nbre_pied">
                          <th mat-header-cell *matHeaderCellDef> Nbre_pieds </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.nbre_pied}}
                            </span>
                          </td>
                        </ng-container>
                        
                        <!-- long_ligne Ligne Column -->
                        <ng-container matColumnDef="long_ligne">
                          <th mat-header-cell *matHeaderCellDef> Long_ligne </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.long_ligne}}
                            </span>
                          </td>
                        </ng-container>

                        <!-- Nombre Ligne Column -->
                        <ng-container matColumnDef="nbre_ligne">
                          <th mat-header-cell *matHeaderCellDef> Nbre_ligne </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.nbre_ligne}}
                            </span>
                          </td>
                        </ng-container>
            
                        <!-- Ex Column -->
                        <ng-container matColumnDef="ex">
                          <th mat-header-cell *matHeaderCellDef> EX </th>
                          <td mat-cell *matCellDef="let row; let i = index"> 
                            <span>
                              {{row.ex}}
                            </span>
                          </td>
                        </ng-container>
            
                        <tr mat-header-row *matHeaderRowDef="displayedColumnsAllSvMv; sticky: true"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumnsAllSvMv;"></tr>
                    
                        <!-- Row shown when there is no matching data. -->
                        <tr class="mat-row" *matNoDataRow>
                          <td class="mat-cell" colspan="14">Aucun enregistrement"</td>
                        </tr>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ion-accordion>
        </ion-accordion-group>
      </div>
    </mat-tab>
  </mat-tab-group>
</ion-content>
